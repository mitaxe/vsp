function clone(e){if(null===e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function dynamicSort(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(n,a){var o=n[e]<a[e]?-1:n[e]>a[e]?1:0;return o*t}}var app=angular.module("MainApp",["ui.router","angular-loading-bar","ngAnimate","ngTouch","angular-sortable-view","ngSanitize","ngMessages"]);app.run(["$rootScope","$document","$locale","$state",function(e,t,n,a){e.$on("$stateChangeSuccess",function(e,t,n,a,o){a.name.indexOf("user.")>=0&&t.name.indexOf("user.")>=0||a.name.indexOf("channels.")>=0&&t.name.indexOf("channels.")>=0||(document.body.scrollTop=document.documentElement.scrollTop=0)}),n.NUMBER_FORMATS.GROUP_SEP=" ",n.NUMBER_FORMATS.DECIMAL_SEP="."}]),angular.module("MainApp").config(["$stateProvider","$urlRouterProvider","cfpLoadingBarProvider","$locationProvider",function(e,t,n,a){n.parentSelector="#loading-bar-container",n.includeSpinner=!1,t.otherwise("/"),t.when("/history","/history/viewed").when("/ratings","/ratings/videos").when("/search","/search/all").when("/channels/:id","/channels/:id/all").when("/settings","/settings/main").when("/edit-channel/:id","/edit-channel/:id/main"),e.state("home",{url:"/",templateUrl:"app/views/home.html",controller:"HomeCtrl",resolve:{homeVideos:["factory",function(e){return console.time("homeRequestTime"),e.getHomeData()}]}}).state("exclusive",{url:"/exclusive",templateUrl:"app/views/exclusive.html",controller:"ExclusiveCtrl",resolve:{exclusiveVideos:["factory",function(e){return e.getExclusiveData()}]}}).state("ratings",{url:"/ratings",templateUrl:"app/views/ratings/ratings.html",controller:"RatingsCtrl",resolve:{ratingsVideos:["factory",function(e){return e.getRatingsVideos()}],ratingsChannels:["factory",function(e){return e.getRatingsChannels()}]}}).state("ratings.videos",{url:"/videos",templateUrl:"app/views/ratings/ratings-videos.html"}).state("ratings.channels",{url:"/channels",templateUrl:"app/views/ratings/ratings-channels.html"}).state("login",{url:"/login",templateUrl:"app/views/auth/login.html"}).state("search",{url:"/search",templateUrl:"app/views/search/search.html",redirectTo:"search.all",controller:"SearchCtrl"}).state("search.all",{url:"/all/:key",templateUrl:"app/views/search/search-all.html"}).state("search.videos",{url:"/video/:key",templateUrl:"app/views/search/search-video.html"}).state("search.channels",{url:"/channel/:key",templateUrl:"app/views/search/search-channels.html"}).state("search.articles",{url:"/articles/:key",templateUrl:"app/views/search/search-articles.html"}).state("newVideos",{url:"/new-videos",templateUrl:"app/views/new-videos.html",controller:"NewVideosCtrl",resolve:{newVideos:["factory",function(e){return e.getNewVideosData()}]}}).state("blog",{url:"/blog",templateUrl:"app/views/blog.html",resolve:{blogData:["factory",function(e){return e.getBlogData()}]},controller:["$scope","blogData",function(e,t){e.blogData=t.data.data}]}).state("article",{url:"/blog/:id",templateUrl:"app/views/article.html",resolve:{articleData:["factory","$stateParams",function(e,t){return e.getArticleData(t.id)}],otherArticles:["factory","$stateParams",function(e,t){return e.getOtherArticles(t.id)}]},controller:["$scope","articleData","otherArticles",function(e,t,n){e.article=t.data.data,e.articles=n.data.data}]}).state("history",{url:"/history",templateUrl:"app/views/history/history.html",controller:"HistoryCtrl",resolve:{historyData:["factory",function(e){return e.getHistoryData()}]}}).state("history.viewed",{url:"/viewed",templateUrl:"app/views/history/history-viewed.html"}).state("history.liked",{url:"/liked",templateUrl:"app/views/history/history-liked.html"}).state("profile",{url:"/profile/:id",templateUrl:"app/views/profile/profile.html",controller:"ProfileCtrl",resolve:{userData:["factory","$stateParams",function(e,t){return e.getUserData(t.id)}]}}).state("profile-edit",{url:"/profile-edit/:id",templateUrl:"app/views/profile/profile-edit.html",controller:"ProfileCtrl",resolve:{userData:["factory","$stateParams",function(e,t){return e.getUserData(t.id)}]}}).state("add-channel",{url:"/add-channel",templateUrl:"app/views/add-channel.html"}).state("video-edit",{url:"/video-edit",templateUrl:"app/views/settings/video-settings.html",controller:"VideoSettingsCtrl"}).state("notifications-comments",{url:"/notifications/comments",templateUrl:"app/views/notifications/notifications-comments.html"}).state("notifications-all",{url:"/notifications/all",templateUrl:"app/views/notifications/notifications-all.html"}).state("channels",{url:"/channels/:id",templateUrl:"app/views/channels/xchannel.html",controller:"xChannelCtrl",scope:{content:"="},resolve:{mainChannel:["factory","$stateParams",function(e,t){return e.getChannelData(t.id)}]}}).state("channels.all",{url:"/all",templateUrl:"app/views/channels/xchannel-all.html"}).state("channels.playlist",{url:"/playlist",templateUrl:"app/views/channels/xchannel-playlists.html"}).state("playlist",{url:"/playlists/:id",templateUrl:"app/views/channels/playlist.html",controller:"PlaylistCtrl",resolve:{mainPlaylist:["factory","$stateParams",function(e,t){return e.getPlaylistData(t.id)}]}}).state("channels.shop",{url:"/shop",templateUrl:"app/views/channels/xchannel-shop.html"}).state("edit-channel",{url:"/edit-channel/:id",templateUrl:"app/views/settings/settings.html",controller:"SettingsCtrl"}).state("edit-channel.main",{url:"/main",templateUrl:"app/views/settings/settings-main.html",controller:"SettingsCtrl"}).state("edit-channel.playlists",{url:"/playlists",templateUrl:"app/views/settings/settings-video.html",controller:"SettingsCtrl"}).state("shop-detailed",{url:"/shop/:itemId",templateUrl:"app/views/channels/shop-detail.html",controller:"ShopDetailCtrl"}).state("videos",{url:"/videos/:id",templateUrl:"app/views/videopage.html",scope:{content:"="},controller:"VideoPageCtrl",resolve:{mainVideos:["factory","$stateParams",function(e,t){return e.getVideoPageMainVideos(t.id)}]}}).state("test",{url:"/test",templateUrl:"app/views/test.html"})}]),app.filter("startFrom",function(){return function(e,t){return e?(t=+t,e.slice(t)):[]}}),app.filter("prettyDate",function(){return function(e,t){var n=new Date((e||"").replace(/-/g,"/").replace(/[TZ]/g," ")),a=((new Date).getTime()-n.getTime())/1e3,o=Math.floor(a/86400),i=Math.floor(a/31536e3);if(!(isNaN(o)||0>o)){var s;s=t&&1>o?"Сегодня":0===o&&(60>a&&"Только что"||120>a&&"1 минуту назад"||3600>a&&Math.floor(a/60)+" минут назад"||7200>a&&"1 час назад"||86400>a&&Math.floor(a/3600)+" часов назад")||1>o&&today&&"Сегодня"||1==o&&"Вчера"||7>o&&o+" дней назад"||31>o&&Math.ceil(o/7)+" недель назад"||1>i&&Math.ceil(o/30)+" месяц назад"||1==i&&i+" год назад"||i>1&&i+" лет назад"||"неизвестная дата";var r=parseInt(s);return r&&(s="<span class='thumb__number'>"+r+"</span>"+s.replace(/[0-9]/g,"")),s}}}),app.filter("secondsToTime",function(){function e(e){return 10>e?"0"+e:e}return function(t){if("number"!=typeof t||0>t)return"00:00:00";var n=Math.floor(t/3600),a=Math.floor(t%3600/60),o=Math.floor(t%60);return n?e(n)+":"+e(a)+":"+e(o):e(a)+":"+e(o)}}),app.filter("trimText",function(){return function(e,t,n){return null===e?"":n?"..."+e.slice(t):e.length>t?e.slice(0,t)+"...":e}}),angular.module("MainApp").factory("factory",["$http",function(e){var t={},n="http://vsponline.qa";return t.getHomeData=function(){return e.get(n+"/index/videos")},t.getExclusiveData=function(t){return t=t||"",e.get(n+"/exclusive/videos?offset="+t)},t.getNewVideosData=function(t){return t=t||"",e.get(n+"/new/videos?offset="+t)},t.getRatingsVideos=function(t){return t=t||"",e.get(n+"/ratings/videos?offset="+t)},t.getRatingsChannels=function(t){return t=t||"",e.get(n+"/ratings/channels?offset="+t)},t.getVideoPageMainVideos=function(t){return e.get(n+"/videos/"+t)},t.getVideoPageComments=function(t){return e.get(n+"/videos/"+t+"/comments")},t.getRelatedVideos=function(t){return e.get(n+"/videos/"+t+"/related_videos")},t.getRelatedChannels=function(t){return e.get(n+"/videos/"+t+"/related_channels")},t.getChannelData=function(t){return e.get(n+"/channels/"+t)},t.getChannelVideos=function(t){return e.get(n+"/channels/"+t+"/videos")},t.getChannelPlaylists=function(t){return e.get(n+"/channels/"+t+"/playlists")},t.getChannelGoods=function(t){return e.get(n+"/channels/"+t+"/goods")},t.getPlaylistData=function(t){return e.get(n+"/playlists/"+t)},t.getPlaylistVideos=function(t,a){return a=a||"",e.get(n+"/playlists/"+t+"/videos?offset="+a)},t.getBlogData=function(){return e.get(n+"/articles")},t.getArticleData=function(t){return e.get(n+"/articles/"+t)},t.getOtherArticles=function(t){return e.get(n+"/articles/"+t+"/other")},t.getHistoryData=function(){return e.get(n+"/videos/groups/history")},t.getVideos=function(){return e.get("./assets/js/data.json")},t.getSearchVideos=function(t,a){return console.log("key - ",t,"offset - ",a),e.get(n+"/index/search/videos?q="+t+"&offset="+a)},t.getSearchChannels=function(t,a){return console.log("key - ",t,"offset - ",a),e.get(n+"/index/search/channels?q="+t+"&offset="+a)},t.getSearchArticles=function(t,a){return console.log("key - ",t,"offset - ",a),e.get(n+"/index/search/articles?q="+t+"&offset="+a)},t.loginUser=function(t){return e.post(n+"/users/login",t)},t.userCommonData=function(){return e.get(n+"/users/common")},t.getRecommendedChannels=function(){return e.get(n+"/channels/groups/recommended")},t.getUserData=function(t){return e.get(n+"/users/"+t)},t.getUserChannels=function(t){return e.get(n+"/users/"+t+"/channels")},t.updateUserProfile=function(t,a){return e.put(n+"/users/"+t,a)},t}]),angular.module("MainApp").controller("CommentsCtrl",["$scope","$sce","factory",function(e,t,n){e.commentsLength=function(){if(e.comments){for(var t=0,n=0;n<e.comments.length;n++){t+=1;for(var a=0;a<e.comments[n].responses.length;a++)t+=1}return t}},e.allowInput=function(t,n){for(var a=0;a<e.comments.length;a++){e.comments[a].inputAllowed=!1;for(var o=0;o<e.comments[a].responses.length;o++)e.comments[a].responses[o].inputAllowed=!1}void 0!==t&&void 0===n?e.comments[t].inputAllowed=!0:void 0!==t&&void 0!==n&&(e.comments[t].responses[n].inputAllowed=!0)},e.isInputAllowed=function(t,n){return void 0!==t&&void 0===n?e.comments[t].inputAllowed:void 0!==t&&void 0!==n?e.comments[t].responses[n].inputAllowed:void 0},e.addComment=function(t,n,a){if(t){var o=(new Date).toLocaleString(),i={user:e.currentUser.name,text:t,link:"#",img:e.currentUser.avatar,date:o,likes:0,responses:[]};void 0!==a?(i.text=e.comments[n].responses[a].user+", "+i.text,e.comments[n].responses.splice(a+1,0,i)):void 0!==n?e.comments[n].responses.unshift(i):e.comments.unshift(i)}}}]),angular.module("MainApp").controller("ExclusiveCtrl",["$scope","factory","exclusiveVideos",function(e,t,n){e.exclusiveVideos=n.data.data,e.initialOffset=n.data.meta.count,e.request=t.getExclusiveData}]),angular.module("MainApp").controller("HistoryCtrl",["$scope","factory","historyData",function(e,t,n){t.getHistoryData().success(function(t){e.historyData=t.data,console.log("History data - ",e.historyData)}),e.historyFilter=function(e,t,n){return!0}}]),angular.module("MainApp").controller("HomeCtrl",["$scope","homeVideos",function(e,t){console.timeEnd("homeRequestTime"),e.homeVideos=t.data.data}]),angular.module("MainApp").controller("MainCtrl",["$scope","$sce","factory","$state","$window","$http","$timeout",function(e,t,n,a,o,i,s){function r(){n.loginUser(e.loginData).then(function(t){console.log("login response - ",t),console.log("Assigned user token - "+t.data.data.token),n.userCommonData().success(function(t){e.userData=t.data,console.log("User common data - ",e.userData)}),e.user.authorized=!0,localStorage.setItem("userToken",t.data.data.token),localStorage.setItem("loginData",JSON.stringify(e.loginData)),i.defaults.headers.common.Authorization=t.data.data.token,e.userId=t.data.data.vspUserId,e.logging=!1,e.showloginModal=!1,console.log("login data",e.loginData)},function(t){e.logging=!1,e.showloginModal=!1,console.log("error - ",t)})}e.remove=function(e,t){void 0!==t&&("all"===t?e.length=0:e.splice(e.indexOf(t),1))},e.goSearch=function(){e.searchKey&&(e.searching=!0,e.searchActive=!0,a.go("search.all",{key:e.searchKey},{reload:!0}))},e.hideMenuMob=function(){console.log("hide mob"),o.innerWidth<768&&(e.sandwichClicked=!1)},n.getRecommendedChannels().success(function(t){e.recommendedChannels=t.data,console.log("Recommended channels - ",e.recommendedChannels)}),e.$on("$stateChangeSuccess",function(){a.includes("login")&&(e.showloginModal=!0)}),e.user={},e.loginData={},e.form={},e.getLoginBtnText=function(){return o.innerWidth<1280?"Войти":"Авторизация"},localStorage.getItem("userToken")&&(console.log("token in local storage"),e.loginData=JSON.parse(localStorage.getItem("loginData")),e.user.authorized=!0,r()),e.loginUser=function(){return angular.forEach(e.form.login.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}),e.form.login.$invalid?void console.log("invalid form"):(console.log("sending login request for - ",e.loginData),e.logging=!0,void r())},e.registerData={},e.registerUser=function(){return angular.forEach(e.form.register.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}),e.form.register.$invalid?void console.log("registration form invalid"):void console.log("sending registration request for - ",e.registerData)},e.logout=function(){console.log("logged out"),e.user.authorized=!1,localStorage.clear()},n.getVideos().success(function(t){e.videos=t.videos,e.goods=t.goods,e.comments=t.comments}),e.limits={videos:4,channels:6,blogs:6,comments:2,reqCnt:0},e.categories=["Общее","Машини","Самолеты","Природа"]}]),angular.module("MainApp").controller("NewVideosCtrl",["$scope","newVideos","factory",function(e,t,n){e.newVideos=t.data.data,e.initialOffset=t.data.meta.count,e.request=n.getNewVideosData}]),angular.module("MainApp").controller("PlaylistCtrl",["$scope","mainPlaylist","factory","$stateParams",function(e,t,n,a){e.mainPlaylist=t.data.data,e.request=n.getPlaylistVideos,e.request(a.id).success(function(t){e.playlistVideos=t.data,e.initialOffset=t.meta.count}),e.id=a.id}]),angular.module("MainApp").controller("ProfileCtrl",["$scope","$stateParams","userData","factory",function(e,t,n,a){e.saveProfile=function(){return e.formTried=!0,angular.forEach(e.form.editProfile.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}),e.form.editProfile.$invalid?void console.log("form invalid"):(console.log("saved profile",e.profileSettings),e.saving=!0,void a.updateUserProfile(t.id,e.profileSettings).then(function(){console.log("success",e.form.editProfile.$error)},function(t){e.serverValidations={email:[{type:"maxlength",message:"Max length is 40 sym"}]},console.log(e.serverValidations.email);for(var n in e.serverValidations)e.form.editProfile[n]&&(e.form.editProfile[n].$setValidity(e.serverValidations[n].type,!1),e.form.editProfile[n].$setTouched())}))},e.videosCounter=110,n&&(e.userData=n.data.data),a.getUserChannels(t.id).success(function(t){e.userChannels=t,console.log("user channels",t)}),e.profile={user:{avatar:"assets/img/prof_img.png",name:"Burav4ik24",fbLink:"http://fb.com/",userInfo:"25 лет, Есть свой личный пранк канал. Веду активный способ жизни. мой вебсайт:",userWebsite:"http://google.com",userCity:"Киев",userCountry:"Украина"},userChannels:1,userAva:"assets/img/u1.png",channel:{channelName:"RomanAtwood",channelSubscribers:18358461}},e.profileSettings={email:"test2@test.com",password:"qwerty12345"}}]),angular.module("MainApp").controller("RatingsCtrl",["$scope","factory","ratingsVideos","ratingsChannels",function(e,t,n,a){e.ratingsVideos=n.data.data,e.videosOffset=n.data.meta.count,e.videosRequest=t.getRatingsVideos,e.ratingsChannels=a.data.data,e.channelsOffset=a.data.meta.count,e.channelsRequest=t.getRatingsChannels}]),angular.module("MainApp").controller("SearchCtrl",["$scope","factory","$stateParams",function(e,t,n){if(e.requestVideos=t.getSearchVideos,e.requestChannels=t.getSearchChannels,e.requestArticles=t.getSearchArticles,e.searchTitle=e.searchKey,e.searchKey){var a=e.searchKey;e.requestVideos(a,e.videosOffset).success(function(t){console.log("videos - ",t),e.searchActive=!1,e.searching=!1,e.searchVideos=t.data,e.videosOffset=t.meta.count||0,e.videosCount=t.meta.totalCount||0}),e.requestChannels(a,e.channelsOffset).success(function(t){console.log("channels - ",t),e.searchChannels=t.data,e.channelsOffset=t.meta.count||0,e.channelsCount=t.meta.totalCount||0}),e.requestArticles(a,e.articlesOffset).success(function(t){console.log("articles - ",t),e.searchArticles=t.data,e.articlesOffset=t.meta.count||0,e.articlesCount=t.meta.totalCount||0}),e.totalCount=function(){return e.videosCount>=0&&e.channelsCount>=0&&e.articlesCount>=0?e.videosCount+e.channelsCount+e.articlesCount:void 0}}}]),angular.module("MainApp").controller("SettingsCtrl",["$scope","$sce",function(e,t){e.channelSettings={email:"test@test.com"},e.channelPlaylists={playlists:[{name:"Оригинальные пранки",inner:[{name:"Пранки",hidden:!1},{name:"test2",hidden:!1},{name:"Пранки 2",hidden:!1},{name:"test4",hidden:!1}]},{name:"Лучшие видео",inner:[{name:1,hidden:!1},{name:"Пранк",hidden:!1}]},{name:"Пантера Шоу",inner:[{name:"Пранк",hidden:!1},{name:"Пранк 2",hidden:!1}]}]},e.saveChannel=function(){return e.formTried=!0,angular.forEach(e.form.channelSettings.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}),e.form.channelSettings.$invalid?void console.log("form invalid"):(console.log("saved channels settings",e.channelSettings),e.saving=!0,void setTimeout(function(){e.saving=!1,e.$apply()},2e3))},e.savePlaylists=function(){return e.formTried=!0,angular.forEach(e.form.channelPlaylists.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}),e.form.channelPlaylists.$invalid?void console.log("form invalid"):(console.log("saved playlists",e.channelPlaylists),e.saving=!0,void setTimeout(function(){e.saving=!1,e.$apply()},2e3))},e.highlight=function(e,n){return n?t.trustAsHtml(e.replace(new RegExp(n,"gi"),'<span class="highlightedText">$&</span>')):t.trustAsHtml(e.toString())}}]),angular.module("MainApp").controller("ShopDetailCtrl",["$scope","$stateParams","$window",function(e,t,n){e.itemDetails={name:t.itemId,images:["assets/img/tshort1.png","assets/img/tshort2.png","assets/img/tshort3.png"],description:"The CHOPPED Tee shirt is finally here, printed front AND back for maximum choppage! Chopped fingers on the front when they see you coming, then CHOPPED text on the back so fools know they've been CHOPPED when you stride past! - See more at: http://mightycarmods.com/collections/clothing/products/chopped-tee-shirt#sthash.v0DcQcBb.dpuf",price:10},e.mainImageUrl=e.itemDetails.images[0],e.setImage=function(t){e.mainImageUrl=t},e.selectedPreview=0,e.setPreview=function(t){e.selectedPreview=t},e.wrapperWidth=0,e.sliderWidth=0,e.currentIndex=0,e.setWrapperWidth=function(t){e.wrapperWidth=document.querySelectorAll(".mb_slider")[0].clientWidth*t+"px",e.sliderWidth=document.querySelectorAll(".mb_slider")[0].clientWidth+"px"},e.$on("resize::resize",function(){e.setWrapperWidth(e.itemDetails.images.length)}),e.setWrapperWidth(e.itemDetails.images.length),angular.element(n).bind("resize",function(){e.$apply()}),e.isCurrentSlideIndex=function(t){return e.currentIndex===t},e.prevSlide=function(){e.currentIndex=e.currentIndex<e.itemDetails.images.length-1?++e.currentIndex:0,document.getElementById("sWr").style.left=-(document.querySelectorAll(".mb_slider")[0].clientWidth*e.currentIndex)+"px"},e.nextSlide=function(){e.currentIndex=e.currentIndex>0?--e.currentIndex:e.itemDetails.images.length-1,document.getElementById("sWr").style.left=-(document.querySelectorAll(".mb_slider")[0].clientWidth*e.currentIndex)+"px"}}]),angular.module("MainApp").controller("VideoPageCtrl",["$scope","$sce","$window","factory","$stateParams","mainVideos","$rootScope",function(e,t,n,a,o,i,s){e.mainVideos=i.data.data,console.log("main videos",i),s.videoPageChannel=i.data.data[0],e.iframeSrc=function(e){var n=t.trustAsResourceUrl("https://www.youtube.com/embed/"+e);return n},a.getVideoPageComments(o.id).success(function(t){e.comments=t.data.comments,console.log("comments ",e.comments)}),a.getRelatedVideos(o.id).success(function(t){e.relatedVideos=t.data,console.log("related videos ",e.relatedVideos)}),a.getRelatedChannels(o.id).success(function(t){e.relatedChannels=t.data,console.log("relatedChannels ",e.relatedChannels)});var r=window.innerWidth;e.activeTab=r>1280?1:3,e.desktop=r>1280,e.setActiveTab=function(t){e.activeTab=t},e.$on("resize::resize",function(){window.innerWidth<1280?(e.desktop=!1,e.activeTab=3):(e.desktop=!0,e.activeTab=1)}),angular.element(n).bind("resize",function(){e.$apply()})}]),angular.module("MainApp").controller("VideoSettingsCtrl",["$scope",function(e){e.videoSettings={url:"https://www.youtube.com/watch?v=HQx5Be9g16U",title:"10 Amazing Science Tricks Using Liquid!",description:"Add me on Facebook (click LIKE on Facebook to add me) - http://www.facebook.com/brusspup Download the music in this video: Song #1: Abyss - iTunes: https://itunes.apple.com/us/album/aby.",img:"assets/img/video-img.png",show:"true",playlists:[{name:"Все видео",selected:!0},{name:"Пранк шоу",selected:!1},{name:"Видеобаттлы с другими каналами",selected:!0},{name:"История одного дня",selected:!1}],category:""},e.saveVideoSettings=function(){return e.formTried=!0,angular.forEach(e.form.videoSettings.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}),e.form.videoSettings.$invalid?void console.log("form invalid"):(console.log("saved video settings",e.videoSettings),e.saving=!0,void setTimeout(function(){e.saving=!1,e.$apply()},2e3))}}]),angular.module("MainApp").controller("xChannelCtrl",["$scope","$stateParams","mainChannel","factory","$window",function(e,t,n,a,o){e.content=n.data.data,a.getChannelVideos(t.id).success(function(t){e.channelVideos=t.data,console.log("related videos ",e.channelVideos)}),a.getChannelPlaylists(t.id).success(function(t){e.channelPlaylists=t.data,console.log("channels playlists ",e.channelPlaylists)}),a.getChannelGoods(t.id).success(function(t){e.channelGoods=t.data,console.log("channels goods ",e.channelGoods)}),e.sortTypes=["По дате добавления [новые]","По дате добавления [старые]"],e.selectedSortType=e.sortTypes[0],e.sortReverse=!0,e.sortBy=function(t){e.sortReverse=0===t}}]),angular.module("MainApp").directive("accordion",["$timeout",function(e){return{restrict:"C",transclude:!0,template:"<div ng-transclude></div>",link:function(e,t,n){function a(){var e=angular.element(t[0].querySelectorAll("[toggler]")),n=(angular.element(t[0].querySelectorAll(".accordion__pannel")),angular.element(t[0].querySelectorAll(".accordion__content")));angular.forEach(e,function(t,a){t.onclick=function(){if(-1!=t.className.indexOf("active"))t.className=t.className.replace(/\bactive\b/,""),console.log(t.className);else{angular.forEach(e,function(e){e.className=e.className.replace(/\bactive\b/,"")});n[a].clientHeight;t.className+=" active"}}})}a(),e.$watch(function(){return t[0].querySelectorAll("[toggler]").length},function(e,t){e!==t&&a()})}}}]),app.directive("backButton",["$document","$state","$stateParams","$rootScope",function(e,t,n,a){return{restrict:"E",template:'<div a ng-click="backButton.goBack()" class="header__item header__back" ng-class="{searchActive:searchActive, pointer:backButton.available, videopage:videopage}"><div ng-show="backButton.available" class="table-middle"><i class="svg"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="12" viewBox="0 0 28.914 16.998"><path fill-rule="evenodd" clip-rule="evenodd" fill="" d="M28.914 2.857L26.057 0l-11.66 11.66L2.83.093 0 2.924l13.98 13.98.35-.348.44.442"/></svg></i><p ng-bind-html="backButton.text"></p></div></div>',link:function(e,o){console.log(e.videoPageChannel),e.backButton={available:!1,text:"",prevState:"",id:n.id,init:function(){switch(!0){case t.includes("article"):this.available=!0,this.text="Блог",this.prevState="blog";break;case t.includes("profile"):this.available=!0,this.text="Назад",this.prevState="";break;case t.includes("shop-detailed"):this.available=!0,this.text="Магазин",this.prevState="shop-detailed";break;case t.includes("search"):this.available=!0,this.text="Назад",this.prevState="home";break;case t.includes("edit-channel"):this.available=!0,this.text="Назад",this.prevState="channels";break;case t.includes("videos"):this.available=!0,e.videopage=!0,this.text='<img src="'+a.videoPageChannel.img+'"/><div>'+a.videoPageChannel.user+'<br><span class="subscription"><span>Подписаться</span>1 000 000</span></div>',this.prevState="channels",this.id=a.videoPageChannel.channelId;break;default:this.available=!1,e.videopage=!1}},goBack:function(){t.go(this.prevState,{id:this.id})}},e.$on("$stateChangeSuccess",function(){e.backButton.init()})}}}]),app.directive("focusMe",["$timeout",function(e){return{link:function(t,n,a){t.$watch(a.focusMe,function(t){t===!0&&(console.log("value=",t),e(function(){n[0].focus()},100))})}}}]),app.directive("loadMore",["$document",function(e){return{restrict:"E",scope:{parameters:"=params"},template:'<a class="btn btn-more">{{ getButtonText() }} </a>',link:function(e,t){function n(t,n,a,o){e.noMoreResponse||(e.loadingMore=!0,e.offset+=a,o=o||e.offset,t(o,e.offset).success(function(t){console.log("loadmore response - ",t),e.loadingMore=!1,null!==t.data?(n.push.apply(n,t.data),console.log("items loaded already - ",n.length),t.data.length<a&&(e.noMoreResponse=!0)):e.noMoreResponse=!0}))}e.offset=0,e.getButtonText=function(){var n;return e.loadingMore&&!e.noMoreResponse?n="идет загрузка...":e.loadingMore||e.noMoreResponse?t[0].style.display="none":n="загрузить еще",n},t.on("click",function(t){n.apply(this,e.parameters)})}}}]),angular.module("MainApp").directive("modal",["$timeout",function(e){return{restrict:"E",transclude:!0,scope:{showModal:"=show",sandwichCliked:"=position"},templateUrl:"app/views/common/modal.html",link:function(e,t,n){}}}]),app.directive("ngEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.ngEnter)}),t.preventDefault())})}}),app.directive("popoverTrigger",["$document",function(e){return{restrict:"A",link:function(t,n){e.on("click",function(){(t.userActive||t.notificationActive)&&t.$apply(function(){t.userActive=!1,t.notificationActive=!1})}),n.on("click",function(e){t.userActive&&t.notificationActive||e.stopPropagation()})}}}]),app.directive("popover",["$document",function(e){return{restrict:"A",link:function(e,t){t.on("click",function(t){e.userActive&&e.notificationActive||t.stopPropagation()})}}}]),angular.module("MainApp").directive("overlay",["$interval",function(e){return{restrict:"E",controller:"MainCtrl",replace:!0,template:'<div class="overlay" ng-class="{active:popupActive}" ng-click="hidePopup()"><div class="modal" ng-include="content"></div></div>',link:function(e,t,n){e.showPopup=function(t){e.content="app/views/"+t+".html",e.popupActive=!0},e.hidePopup=function(){e.content="",e.popupActive=!1}}}}]),angular.module("MainApp").directive("readMore",["$timeout",function(e){return{restrict:"E",replace:!0,scope:{content:"=text"},template:'<div ng-show="content.length > 0" ><span class="block-with-text" ng-class="{expanded:expanded}"><span class="block-with-text__content" ng-bind-html="content"></span></span><span class="block-with-text__read-more" ng-click="expanded = !expanded" ng-class="{expanded:expanded}" ng-show="showReadMore"><span>{{ expanded ? "Скрыть" : "Читаь далее" }}</span><i class="svg"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 28.914 16.998"><path fill-rule="evenodd" clip-rule="evenodd" fill="" d="M28.914 2.857L26.057 0l-11.66 11.66L2.83.093 0 2.924l13.98 13.98.35-.348.44.442"/></svg></i></span></div>',link:function(t,n,a){e(function(){var e=n[0].getElementsByClassName("block-with-text"),a=n[0].getElementsByClassName("block-with-text__content");console.log(e[0].clientHeight,a[0].clientHeight),console.log(e),e[0].clientHeight<a[0].clientHeight&&(console.log("hidden"),t.showReadMore=!0)},0)}}}]),angular.module("MainApp").directive("slider",["$timeout",function(e){return{restrict:"E",transclude:!0,scope:{slidesN:"=slides",limitTo:"=limitto",perSlide:"=perslide"},template:'<div class="slider" ng-class="{sliderReady:sliderReady}"><div class="slider__box"><div class="slider__inner"><div ng-transclude></div></div></div><ul class="slider__pager"><li ng-class="{active: isActiveSlide($index)}" ng-model="activeSlide" ng-click="slideTo($index)" ng-repeat="i in pages"></li></ul></div>',link:function(t,n,a){e(function(){t.pages=[],t.activeSlide=0;var e=t.perSlide||4,a=12,o=n[0].querySelectorAll(".slider__slide");o.length=o.length>a?a:o.length;for(var i=0;i<o.length/e;i++)o.length>e&&t.pages.push(i);t.slideTo=function(i){t.activeSlide=i,o.length<a&&o.length%e>0&&i===t.pages.length-1&&(i=i-1+o.length%e/e),n[0].querySelector(".slider__inner").style.left="-"+100*i+"%"},t.isActiveSlide=function(e){return e===t.activeSlide?!0:void 0}},0)}}}]),angular.module("MainApp").directive("subscribe",["$window",function(e){return{restrict:"E",replace:!0,scope:{subscriber:"=subscribeTo"},template:'<div class="subscribe_box"><span ng-click="subscribe()" class="green_btn" ng-class="{subscribed:subscribed}" ng-mouseover="hoverIn()" ng-mouseleave="hoverOut()"> {{ getButtonText() }} </span><span class="counter subscribe">{{ subscriber | number }}</span></div>',link:function(t,n,a){t.subscribe=function(){t.subscribed=!t.subscribed,t.subscribed?t.subscriber+=1:t.subscriber-=1},t.hoverIn=function(){t.subsButtonHovered=!0},t.hoverOut=function(){t.subsButtonHovered=!1},t.getButtonText=function(){var n="Подписаться";return t.subscribed&&(n="Подписка оформлена",t.subsButtonHovered&&(n="Отменить подписку"),e.innerWidth<1280&&(n="Отменить подписку"),e.innerWidth<768&&(n="Отписаться")),n}}}}]),angular.module("MainApp").directive("tabs",["$rootScope",function(e){return{restrict:"E",replace:!0,scope:{notifications:"=notifications"},link:function(e,t,n){}}}]),angular.module("MainApp").directive("footerview",function(){return{restrict:"E",replace:!0,templateUrl:"app/views/templates/footer.html"}}),angular.module("MainApp").directive("headerview",function(){return{restrict:"E",replace:!0,templateUrl:"app/views/templates/header.html"}}),angular.module("MainApp").directive("sidebarview",function(){return{restrict:"E",replace:!0,templateUrl:"app/views/templates/sidebar.html"}}),angular.module("MainApp").directive("login",function(){return{restrict:"E",replace:!0,templateUrl:"app/views/auth/login-template.html"}}),app.directive("resize",["$window",function(e){return{link:function(t){function n(e){t.$broadcast("resize::resize")}function a(){angular.element(e).off("resize",n)}angular.element(e).on("resize",n),t.$on("$destroy",a)}}}]);